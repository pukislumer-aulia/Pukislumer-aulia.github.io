<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Edit Pesanan â€” Admin</title>

<link rel="stylesheet" href="assets/css/admin-pro.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
  .edit-container {
    max-width: 500px;
    margin: 20px auto;
    background: #1b1f2b;
    padding: 20px;
    border-radius: 14px;
    color: #fff;
    border: 1px solid rgba(255,255,255,0.06);
  }
  .edit-container h2 {
    margin-top: 0;
    color: #ff89b5;
    text-align: center;
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #333;
    margin-bottom: 14px;
    background: #161a25;
    color: #fff;
  }
  button {
    width: 100%;
    padding: 12px;
    border: 0;
    border-radius: 10px;
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 10px;
  }
  .btn-save { background: #38a169; }
  .btn-delete { background: #e53e3e; }
  .btn-back { background: #4a5568; }
</style>

</head>
<body>

<div class="admin-header">Edit Pesanan</div>

<div class="edit-container">
  <h2>Form Edit Pesanan</h2>

  <label>Nama Pemesan:</label>
  <input type="text" id="editNama">

  <label>Nomor WA:</label>
  <input type="text" id="editWA">

  <label>Jenis Pukis:</label>
  <select id="editJenis">
    <option>Original</option>
    <option>Pandan</option>
  </select>

  <label>Isi per Box:</label>
  <select id="editIsi">
    <option value="5">5 pcs</option>
    <option value="10">10 pcs</option>
  </select>

  <label>Topping:</label>
  <input type="text" id="editTopping" placeholder="Topping / Taburan">

  <label>Jumlah Box:</label>
  <input type="number" id="editJumlah" min="1">

  <label>Total Harga:</label>
  <input type="number" id="editTotal" min="0">

  <button class="btn-save" id="saveBtn">Simpan Perubahan</button>
  <button class="btn-delete" id="deleteBtn">Hapus Pesanan</button>
  <button class="btn-back" onclick="window.location.href='admin.html'">Kembali</button>
</div>


 <!-- untuk admin edit: allow editing same topping UI -->
<div class="topping-edit-block">
  <div class="topping-label">Pilih Topping Single (maks 5)</div>
  <div id="editSingleGroup" class="topping-wrap"></div>

  <div style="margin-top:8px" class="topping-label">Pilih Taburan (maks 5)</div>
  <div id="editTaburanGroup" class="topping-wrap"></div>
</div> 
<script>
  /* --- PROTECT PAGE --- */
  if (!sessionStorage.getItem("adminLogged")) {
      window.location.href = "admin-login.html";
  }

  /* --- LOAD ORDER FROM STORAGE --- */
  const id = sessionStorage.getItem("editOrderId");
  const orders = JSON.parse(localStorage.getItem("orders") || "[]");
  const order = orders.find(o => o.id === id);

  if (!order) {
      alert("Pesanan tidak ditemukan.");
      window.location.href = "admin.html";
  }

  /* --- SET FORM DATA --- */
  document.getElementById("editNama").value = order.nama;
  document.getElementById("editWA").value = order.wa;
  document.getElementById("editJenis").value = order.jenis;
  document.getElementById("editIsi").value = order.isi;
  document.getElementById("editTopping").value = order.topping || "";
  document.getElementById("editJumlah").value = order.jumlah;
  document.getElementById("editTotal").value = order.total;

  /* --- SAVE CHANGES --- */
  document.getElementById("saveBtn").onclick = () => {
      order.nama = document.getElementById("editNama").value;
      order.wa = document.getElementById("editWA").value;
      order.jenis = document.getElementById("editJenis").value;
      order.isi = parseInt(document.getElementById("editIsi").value);
      order.topping = document.getElementById("editTopping").value;
      order.jumlah = parseInt(document.getElementById("editJumlah").value);
      order.total = parseInt(document.getElementById("editTotal").value);

      localStorage.setItem("orders", JSON.stringify(orders));

      alert("Perubahan disimpan!");
      window.location.href = "admin.html";
  };

  /* --- DELETE ORDER --- */
  document.getElementById("deleteBtn").onclick = () => {
      if (!confirm("Hapus pesanan ini?")) return;

      const index = orders.indexOf(order);
      orders.splice(index, 1);

      localStorage.setItem("orders", JSON.stringify(orders));

      alert("Pesanan telah dihapus.");
      window.location.href = "admin.html";
  };
</script>

</body>
</html>
